<?php
defined('BASEPATH') OR exit('No direct script access allowed');

class M_excel extends CI_Model {
    private $db;
    public function __construct(){
        parent::__construct();
        $this->db = $this->load->database('local', TRUE);
    }

    public function Anomaliibu($cabang,$tgl_input,$tgl_inputakhir,$periode)
    {
        $dataIbu  = $this->db->query("SELECT * FROM (
                                        SELECT ROW_NUMBER() OVER(order by PERIODE DESC) as NO
                                            ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                                WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                                WHEN [FKDCAB] = 001 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 002 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 003 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 004 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 005 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 006 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 007 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 008 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 009 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 010 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 011 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 012 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 013 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 014 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 015 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 016 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 017 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 018 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 019 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 020 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 021 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 022 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 023 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 024 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 025 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 026 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR BOGOR (TUTUP)'
                                                WHEN [FKDCAB] = 028 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 029 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 030 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 031 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 032 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 033 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 034 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 035 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 036 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 037 then 'KC SOLO'
                                                WHEN [FKDCAB] = 038 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 039 then 'KF BUR CIBINONG (TUTUP)'
                                                WHEN [FKDCAB] = 040 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 041 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 042 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 043 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 044 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 045 then 'KF BUR CIKARANG UTARA (TUTUP)'
                                                WHEN [FKDCAB] = 046 then 'KC YOGYAKARTA'
                                                WHEN [FKDCAB] = 047 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 048 then 'KC SOLO'
                                                WHEN [FKDCAB] = 049 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 050 then 'KC MEDAN'
                                                WHEN [FKDCAB] = 051 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 052 then 'KC PALEMBANG'
                                                WHEN [FKDCAB] = 053 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 054 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 055 then 'KC YOGYAKARTA'
                                                WHEN [FKDCAB] = 056 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 057 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 058 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 059 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 060 then 'KC SOLO'
                                                WHEN [FKDCAB] = 061 then 'KC SOLO'
                                                WHEN [FKDCAB] = 062 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 063 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 064 then 'KC PALEMBANG'
                                                WHEN [FKDCAB] = 065 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 066 then 'KC BANDAR LAMPUNG'
                                                WHEN [FKDCAB] = 067 then 'KC BANDA ACEH'
                                                WHEN [FKDCAB] = 068 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 069 then 'KC MEDAN'
                                                WHEN [FKDCAB] = 070 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 071 then 'KC PANAKKUKANG'
                                                WHEN [FKDCAB] = 072 then 'KC BANDA ACEH'
                                                WHEN [FKDCAB] = 073 then 'KC BANDA ACEH'
                                                WHEN [FKDCAB] = 074 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 075 then 'KC PALEMBANG'
                                                WHEN [FKDCAB] = 076 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 501 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 502 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 503 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 504 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 505 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 506 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 507 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 508 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 521 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 522 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 523 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 524 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 525 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 526 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 527 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 528 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 529 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 530 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 531 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 532 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 533 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 509 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 510 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 511 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 512 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 513 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 514 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 515 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 516 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 517 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 518 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 519 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 520 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 534 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 535 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 536 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 537 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 538 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 539 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 540 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 541 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 542 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 543 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 544 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 545 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 546 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 547 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 548 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 549 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 550 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 551 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 552 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 553 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 554 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 555 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 556 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 557 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 558 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 559 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 560 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 561 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 562 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 563 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 564 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 565 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 566 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 567 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 568 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 569 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 570 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 571 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 572 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 573 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 574 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 575 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 576 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 577 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 578 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 579 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 580 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 581 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 582 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 583 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 584 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 585 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 586 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 587 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 588 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 589 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 590 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 591 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 592 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 593 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 594 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 595 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 596 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 597 then 'KC SAMANHUDI' 
                                                WHEN [FKDCAB] = 598 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 599 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 600 then 'KC SAMANHUDI'
                                                end as [CABANG_INDUK]
                                            ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                                    WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                                    WHEN [FKDCAB] = 001 then 'KCU JATINEGARA'
                                                    WHEN [FKDCAB] = 002 then 'KCU MANGGA DUA'
                                                    WHEN [FKDCAB] = 003 then 'KCU SAMANHUDI'
                                                    WHEN [FKDCAB] = 004 then 'KCU SUNTER'
                                                    WHEN [FKDCAB] = 005 then 'KCU DHARMAWANGSA'
                                                    WHEN [FKDCAB] = 006 then 'KCP KENARI'
                                                    WHEN [FKDCAB] = 007 then 'KCP BEKASI'
                                                    WHEN [FKDCAB] = 008 then 'KCP KELAPA GADING'
                                                    WHEN [FKDCAB] = 009 then 'ULS TANAH ABANG'
                                                    WHEN [FKDCAB] = 010 then 'ULS MARGONDA DEPOK'
                                                    WHEN [FKDCAB] = 011 then 'ULS DARMO'
                                                    WHEN [FKDCAB] = 012 then 'ULS METRO PONDOK INDAH'
                                                    WHEN [FKDCAB] = 013 then 'ULS TANGERANG'
                                                    WHEN [FKDCAB] = 014 then 'ULS BOGOR'
                                                    WHEN [FKDCAB] = 015 then 'ULS VETERAN'
                                                    WHEN [FKDCAB] = 016 then 'ULS SIDOARJO'
                                                    WHEN [FKDCAB] = 017 then 'ULS PASAR MINGGU'
                                                    WHEN [FKDCAB] = 018 then 'ULS CIMANGGIS'
                                                    WHEN [FKDCAB] = 019 then 'ULS TANJUNG PRIOK'
                                                    WHEN [FKDCAB] = 020 then 'ULS KAPAS KERAMPUNG'
                                                    WHEN [FKDCAB] = 021 then 'ULS PONDOK CHANDRA'
                                                    WHEN [FKDCAB] = 022 then 'ULS SEPANJANG'
                                                    WHEN [FKDCAB] = 023 then 'ULS MELAWAI'
                                                    WHEN [FKDCAB] = 024 then 'ULS GUDANG PELURU'
                                                    WHEN [FKDCAB] = 025 then 'ULS KEMANG MANSION'
                                                    WHEN [FKDCAB] = 026 then 'KCP KRANJI BEKASI'
                                                    WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR'
                                                    WHEN [FKDCAB] = 028 then 'KCP CILEDUG TANGERANG'
                                                    WHEN [FKDCAB] = 029 then 'ULS PERAK BARAT'
                                                    WHEN [FKDCAB] = 030 then 'KCU SEMARANG'
                                                    WHEN [FKDCAB] = 031 then 'ULS JUANDA BEKASI'
                                                    WHEN [FKDCAB] = 032 then 'ULS GEDANGAN'
                                                    WHEN [FKDCAB] = 033 then 'ULS GRESIK'
                                                    WHEN [FKDCAB] = 034 then 'ULS MAJAPAHIT'
                                                    WHEN [FKDCAB] = 035 then 'KCU BANDUNG'
                                                    WHEN [FKDCAB] = 036 then 'ULS PURI INDAH'
                                                    WHEN [FKDCAB] = 037 then 'KCU SOLO'
                                                    WHEN [FKDCAB] = 038 then 'KCP PONDOK GEDE'
                                                    WHEN [FKDCAB] = 039 then 'KCP CIBINONG'
                                                    WHEN [FKDCAB] = 040 then 'KCP CIKARANG SELATAN'
                                                    WHEN [FKDCAB] = 041 then 'KCP TANGERANG KOTA'
                                                    WHEN [FKDCAB] = 042 then 'KCP CIPUTAT'
                                                    WHEN [FKDCAB] = 043 then 'KCP DEPOK'
                                                    WHEN [FKDCAB] = 044 then 'KCP CILEUNGSI'
                                                    WHEN [FKDCAB] = 045 then 'KCP CIKARANG UTARA'
                                                    WHEN [FKDCAB] = 046 then 'KCU YOGYAKARTA'
                                                    WHEN [FKDCAB] = 047 then 'ULS PLUIT KENCANA'
                                                    WHEN [FKDCAB] = 048 then 'ULS SOLO SLAMET RIYADI'
                                                    WHEN [FKDCAB] = 049 then 'ULS DAGO'
                                                    WHEN [FKDCAB] = 050 then 'KCU MEDAN'
                                                    WHEN [FKDCAB] = 051 then 'ULS BINTARO'
                                                    WHEN [FKDCAB] = 052 then 'KCU PALEMBANG'
                                                    WHEN [FKDCAB] = 053 then 'KCP MALANG'
                                                    WHEN [FKDCAB] = 054 then 'ULS KOTABARU PARAHYANGAN'
                                                    WHEN [FKDCAB] = 055 then 'ULS SUDIRMAN'
                                                    WHEN [FKDCAB] = 056 then 'ULS KUDUS'
                                                    WHEN [FKDCAB] = 057 then 'ULS PEMUDA'
                                                    WHEN [FKDCAB] = 058 then 'ULS PANDAAN'
                                                    WHEN [FKDCAB] = 059 then 'ULS BUAH BATU'
                                                    WHEN [FKDCAB] = 060 then 'ULS SINGOSAREN'
                                                    WHEN [FKDCAB] = 061 then 'ULS SRAGEN'
                                                    WHEN [FKDCAB] = 062 then 'ULS MOJOKERTO'
                                                    WHEN [FKDCAB] = 063 then 'ULS KEPANJEN'
                                                    WHEN [FKDCAB] = 064 then 'ULS AHMAD RIFAI'
                                                    WHEN [FKDCAB] = 065 then 'ULS BINTARO'
                                                    WHEN [FKDCAB] = 066 then 'KCU BANDAR LAMPUNG'
                                                    WHEN [FKDCAB] = 067 then 'KCU BANDA ACEH'
                                                    WHEN [FKDCAB] = 068 then 'KCP KEDIRI'
                                                    WHEN [FKDCAB] = 069 then 'ULS SETIABUDI'
                                                    WHEN [FKDCAB] = 070 then 'KCP PASURUAN'
                                                    WHEN [FKDCAB] = 071 then 'KCU PANAKKUKANG'
                                                    WHEN [FKDCAB] = 072 then 'KCP LHOKSEUMAWE'
                                                    WHEN [FKDCAB] = 073 then 'ULS BIREUN'
                                                    WHEN [FKDCAB] = 074 then 'ULS TAMAN PONDOK INDAH'
                                                    WHEN [FKDCAB] = 075 then 'ULS SUDIRMAN PALEMBANG'
                                                    WHEN [FKDCAB] = 076 then 'KCP BANYUWANGI'
                                                    WHEN [FKDCAB] = 501 then 'LSBU BEKASI'
                                                    WHEN [FKDCAB] = 502 then 'LSBU CIBUBUR'
                                                    WHEN [FKDCAB] = 503 then 'LSBU KARAWANG'
                                                    WHEN [FKDCAB] = 504 then 'LSBU BANGKALAN'
                                                    WHEN [FKDCAB] = 505 then 'LSBU TUBAN'
                                                    WHEN [FKDCAB] = 506 then 'LSBU BABAT'
                                                    WHEN [FKDCAB] = 507 then 'LSBU PAMEKASAN'
                                                    WHEN [FKDCAB] = 508 then 'LSBU SAMPANG'
                                                    WHEN [FKDCAB] = 521 then 'LSBU CIREBON' 
                                                    WHEN [FKDCAB] = 522 then 'LSBU GARUT' 
                                                    WHEN [FKDCAB] = 523 then 'LSBU SUKABUMI' 
                                                    WHEN [FKDCAB] = 524 then 'LSBU TASIKMALAYA' 
                                                    WHEN [FKDCAB] = 525 then 'LSBU CIANJUR' 
                                                    WHEN [FKDCAB] = 526 then 'LSBU SUBANG' 
                                                    WHEN [FKDCAB] = 527 then 'LSBU PURWAKARTA' 
                                                    WHEN [FKDCAB] = 528 then 'LSBU INDRAMAYU' 
                                                    WHEN [FKDCAB] = 529 then 'LSBU JATIWANGI' 
                                                    WHEN [FKDCAB] = 530 then 'LSBU CIAMIS' 
                                                    WHEN [FKDCAB] = 531 then 'LSBU KUNINGAN CIREBON' 
                                                    WHEN [FKDCAB] = 532 then 'LSBU CIBADAK' 
                                                    WHEN [FKDCAB] = 533 then 'LSBU SUMEDANG' 
                                                    WHEN [FKDCAB] = 509 then 'LSBU PROBOLINGGO' 
                                                    WHEN [FKDCAB] = 510 then 'LSBU SITUBONDO' 
                                                    WHEN [FKDCAB] = 511 then 'LSBU TULUNGAGUNG' 
                                                    WHEN [FKDCAB] = 512 then 'LSBU BLITAR' 
                                                    WHEN [FKDCAB] = 513 then 'LSBU MADIUN' 
                                                    WHEN [FKDCAB] = 514 then 'LSBU PASURUAN' 
                                                    WHEN [FKDCAB] = 515 then 'LSBU KERTOSONO' 
                                                    WHEN [FKDCAB] = 516 then 'LSBU BANYUWANGI' 
                                                    WHEN [FKDCAB] = 517 then 'LSBU BONDOWOSO' 
                                                    WHEN [FKDCAB] = 518 then 'LSBU LUMAJANG' 
                                                    WHEN [FKDCAB] = 519 then 'LSBU MAGETAN' 
                                                    WHEN [FKDCAB] = 520 then 'LSBU NGAWI' 
                                                    WHEN [FKDCAB] = 534 then 'LSBU PURWOKERTO' 
                                                    WHEN [FKDCAB] = 535 then 'LSBU CILACAP' 
                                                    WHEN [FKDCAB] = 536 then 'LSBU PURWODADI' 
                                                    WHEN [FKDCAB] = 537 then 'LSBU MAGELANG' 
                                                    WHEN [FKDCAB] = 538 then 'LSBU PEKALONGAN' 
                                                    WHEN [FKDCAB] = 539 then 'LSBU SALATIGA' 
                                                    WHEN [FKDCAB] = 540 then 'LSBU TEGAL' 
                                                    WHEN [FKDCAB] = 541 then 'LSBU BANJARNEGARA' 
                                                    WHEN [FKDCAB] = 542 then 'LSBU WONOSOBO' 
                                                    WHEN [FKDCAB] = 543 then 'LSBU WONOGIRI' 
                                                    WHEN [FKDCAB] = 544 then 'LSBU PARAKAN' 
                                                    WHEN [FKDCAB] = 545 then 'LSBU JEPARA' 
                                                    WHEN [FKDCAB] = 546 then 'LSBU KEDUNGWUNI' 
                                                    WHEN [FKDCAB] = 547 then 'LSBU KUTUARJO' 
                                                    WHEN [FKDCAB] = 548 then 'LSBU BOYOLALI' 
                                                    WHEN [FKDCAB] = 549 then 'LSBU PURBALINGGA' 
                                                    WHEN [FKDCAB] = 550 then 'LSBU GOMBONG' 
                                                    WHEN [FKDCAB] = 551 then 'LSBU BLOK A CIPETE'
                                                    WHEN [FKDCAB] = 552 then 'LSBU CITY TOWER'
                                                    WHEN [FKDCAB] = 553 then 'LSBU KEBAYORAN BARU'
                                                    WHEN [FKDCAB] = 554 then 'LSBU KUNINGAN'
                                                    WHEN [FKDCAB] = 555 then 'LSBU MENARA BIDAKARA'
                                                    WHEN [FKDCAB] = 556 then 'LSBU PONDOK INDAH'
                                                    WHEN [FKDCAB] = 557 then 'LSBU SCBD'
                                                    WHEN [FKDCAB] = 558 then 'LSBU SUDIRMAN'
                                                    WHEN [FKDCAB] = 559 then 'LSBU THAMRIN'
                                                    WHEN [FKDCAB] = 560 then 'LSBU FATMAWATI'
                                                    WHEN [FKDCAB] = 561 then 'LSBU SABANG'
                                                    WHEN [FKDCAB] = 562 then 'LSBU MENTENG'
                                                    WHEN [FKDCAB] = 563 then 'LSBU PERMATA HIJAU'
                                                    WHEN [FKDCAB] = 564 then 'LSBU KEMANG'
                                                    WHEN [FKDCAB] = 565 then 'LSBU WARUNG BUNCIT'
                                                    WHEN [FKDCAB] = 566 then 'LSBU SANTA'
                                                    WHEN [FKDCAB] = 567 then 'LSBU GUNSA 45'
                                                    WHEN [FKDCAB] = 568 then 'LSBU KALIMALANG'
                                                    WHEN [FKDCAB] = 569 then 'LSBU KELAPA GADING'
                                                    WHEN [FKDCAB] = 570 then 'LSBU MATRAMAN'
                                                    WHEN [FKDCAB] = 571 then 'LSBU RAWAMANGUN'
                                                    WHEN [FKDCAB] = 572 then 'LSBU SUNTER'
                                                    WHEN [FKDCAB] = 573 then 'LSBU WISMA MILLENIA'
                                                    WHEN [FKDCAB] = 574 then 'LSBU SILIWANGI'
                                                    WHEN [FKDCAB] = 575 then 'LSBU CEMPAKA  PUTIH RAYA'
                                                    WHEN [FKDCAB] = 576 then 'LSBU SUNTER  AGUNG'
                                                    WHEN [FKDCAB] = 577 then 'LSBU DEWI SARTIKA'
                                                    WHEN [FKDCAB] = 578 then 'LSBU ASEMKA'
                                                    WHEN [FKDCAB] = 579 then 'LSBU GAJAH MADA'
                                                    WHEN [FKDCAB] = 580 then 'LSBU MANGGA DUA RAYA'
                                                    WHEN [FKDCAB] = 581 then 'LSBU MUARA KARANG'
                                                    WHEN [FKDCAB] = 582 then 'LSBU PANGERAN JAYAKARTA'
                                                    WHEN [FKDCAB] = 583 then 'LSBU PANTAI INDAH KAPUK'
                                                    WHEN [FKDCAB] = 584 then 'LSBU PASAR BARU'
                                                    WHEN [FKDCAB] = 585 then 'LSBU PLUIT'
                                                    WHEN [FKDCAB] = 586 then 'LSBU SURYOPRANOTO'
                                                    WHEN [FKDCAB] = 587 then 'LSBU TAMAN DUTA MAS'
                                                    WHEN [FKDCAB] = 588 then 'LSBU KHM MANSYUR'
                                                    WHEN [FKDCAB] = 589 then 'LSBU GROGOL MUWARDI'
                                                    WHEN [FKDCAB] = 590 then 'LSBU DAAN MOGOT'
                                                    WHEN [FKDCAB] = 591 then 'LSBU GREEN GARDEN'
                                                    WHEN [FKDCAB] = 592 then 'LSBU KEDOYA PERMAI'
                                                    WHEN [FKDCAB] = 593 then 'LSBU PURI INDAH'
                                                    WHEN [FKDCAB] = 594 then 'LSBU WAHID HASYIM'
                                                    WHEN [FKDCAB] = 595 then 'LSBU WISMA ASIA'
                                                    WHEN [FKDCAB] = 596 then 'LSBU KEPA DURI'
                                                    WHEN [FKDCAB] = 597 then 'LSBU KEBON JERUK' 
                                                    WHEN [FKDCAB] = 598 then 'LSBU METRO TANAH ABANG'
                                                    WHEN [FKDCAB] = 599 then 'LSBU KS TUBUN'
                                                    WHEN [FKDCAB] = 600 then 'LSBU TOMANG RAYA'
                                                    end as [NAMA_CABANG]
                                            ,CIF.[FKDCAB] as [KODE_CABANG]	
                                            ,CIF.[FCODE] as	[NOMOR_CIF]	
                                            ,CONVERT(Varchar(20),[FTGLINPUT],103) as	[TANGGAL_BUKA]	
                                            ,CIF.[FNAMA] as	[NAMA_SESUAI_IDENTITAS]
                                            ,CIF.[FREPNAME] as	[NAMA_TANPA_SINGKATAN]
                                            ,CIF.[FNAMAIBU] as	[NAMA_IBU_KANDUNG]
                                            ,CIF.[FUSID] as [USER_INPUT]
                                            ,CIF.[FAUTO] as [USER_OTOR]
                                            ,CONVERT(Varchar(20),[FTGLAUTO],103) as [TGL_OTOR]
                                            ,CONVERT(Varchar(20),[FTGLUBAH],103) as [TGL_PERUBAHAN]
                                            ,CIF.[FJAMUBAH] as [JAM_PERUBAHAN]
                                            ,CASE WHEN CIF.[FJNSNSB] = 'I' THEN 'INDIVIDU'
                                                WHEN CIF.[FJNSNSB] = 'C' THEN 'KORPORASI'
                                                END AS [JENIS_NASABAH]
                                            ,CASE WHEN CIF.[FSTATUS] = 1 THEN 'AKTIF'
                                                WHEN CIF.[FSTATUS] = 0 THEN 'TIDAK AKTIF'
                                                END AS [STATUS]	
                                            ,CIF.[PERIODE]
                                            FROM [BCAS_MIS].[dbo].[CIF] WITH (NOLOCK)
                                        WHERE CIF.FJNSNSB = 'I' 
                                        and [FSTATUS] = 1
                                        and (CIF.[FNAMAIBU] like '-%'
                                            or CIF.[FNAMAIBU] like '%[0-1-2-3-4-5-6-7-8-9]%'
                                            or CIF.[FNAMAIBU] = ''
                                            or CIF.[FNAMAIBU] like 'no name'
                                            or CIF.[FNAMAIBU] like 'ibu'
                                            or CIF.[FNAMAIBU] like 'mama'
                                            or CIF.[FNAMAIBU] like 'mamah'
                                            or CIF.[FNAMAIBU] like 'nn'
                                            or CIF.[FNAMAIBU] like 'zz'
                                            )
                                        and FKDCAB = '$cabang'
                                        and CIF.[FTGLINPUT] between '$tgl_input' and '$tgl_inputakhir'
                                        -- and [FKDCAB] in (001,002)
                                        and [PERIODE] = '$periode'
                                        -- order by CIF.[FTGLINPUT] desc
                                    ) as a")->result();

        return $dataIbu;
    }

    public function Anomalinik($cabang,$tgl_input,$tgl_inputakhir,$periode)
    {
        $dataNik  = $this->db->query("SELECT * FROM (
                                        SELECT ROW_NUMBER() OVER(order by PERIODE DESC) as NO
                                            ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                                WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                                WHEN [FKDCAB] = 001 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 002 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 003 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 004 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 005 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 006 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 007 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 008 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 009 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 010 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 011 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 012 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 013 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 014 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 015 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 016 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 017 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 018 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 019 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 020 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 021 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 022 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 023 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 024 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 025 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 026 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR BOGOR (TUTUP)'
                                                WHEN [FKDCAB] = 028 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 029 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 030 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 031 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 032 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 033 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 034 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 035 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 036 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 037 then 'KC SOLO'
                                                WHEN [FKDCAB] = 038 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 039 then 'KF BUR CIBINONG (TUTUP)'
                                                WHEN [FKDCAB] = 040 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 041 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 042 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 043 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 044 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 045 then 'KF BUR CIKARANG UTARA (TUTUP)'
                                                WHEN [FKDCAB] = 046 then 'KC YOGYAKARTA'
                                                WHEN [FKDCAB] = 047 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 048 then 'KC SOLO'
                                                WHEN [FKDCAB] = 049 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 050 then 'KC MEDAN'
                                                WHEN [FKDCAB] = 051 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 052 then 'KC PALEMBANG'
                                                WHEN [FKDCAB] = 053 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 054 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 055 then 'KC YOGYAKARTA'
                                                WHEN [FKDCAB] = 056 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 057 then 'KC SEMARANG'
                                                WHEN [FKDCAB] = 058 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 059 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 060 then 'KC SOLO'
                                                WHEN [FKDCAB] = 061 then 'KC SOLO'
                                                WHEN [FKDCAB] = 062 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 063 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 064 then 'KC PALEMBANG'
                                                WHEN [FKDCAB] = 065 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 066 then 'KC BANDAR LAMPUNG'
                                                WHEN [FKDCAB] = 067 then 'KC BANDA ACEH'
                                                WHEN [FKDCAB] = 068 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 069 then 'KC MEDAN'
                                                WHEN [FKDCAB] = 070 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 071 then 'KC PANAKKUKANG'
                                                WHEN [FKDCAB] = 072 then 'KC BANDA ACEH'
                                                WHEN [FKDCAB] = 073 then 'KC BANDA ACEH'
                                                WHEN [FKDCAB] = 074 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 075 then 'KC PALEMBANG'
                                                WHEN [FKDCAB] = 076 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 501 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 502 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 503 then 'KC BANDUNG'
                                                WHEN [FKDCAB] = 504 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 505 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 506 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 507 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 508 then 'KC SURABAYA'
                                                WHEN [FKDCAB] = 521 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 522 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 523 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 524 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 525 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 526 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 527 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 528 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 529 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 530 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 531 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 532 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 533 then 'KC BANDUNG' 
                                                WHEN [FKDCAB] = 509 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 510 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 511 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 512 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 513 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 514 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 515 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 516 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 517 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 518 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 519 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 520 then 'KC SURABAYA' 
                                                WHEN [FKDCAB] = 534 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 535 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 536 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 537 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 538 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 539 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 540 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 541 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 542 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 543 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 544 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 545 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 546 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 547 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 548 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 549 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 550 then 'KC SEMARANG' 
                                                WHEN [FKDCAB] = 551 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 552 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 553 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 554 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 555 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 556 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 557 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 558 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 559 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 560 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 561 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 562 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 563 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 564 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 565 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 566 then 'KC MANGGA DUA'
                                                WHEN [FKDCAB] = 567 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 568 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 569 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 570 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 571 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 572 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 573 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 574 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 575 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 576 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 577 then 'KC JATINEGARA'
                                                WHEN [FKDCAB] = 578 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 579 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 580 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 581 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 582 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 583 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 584 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 585 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 586 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 587 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 588 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 589 then 'KC SUNTER'
                                                WHEN [FKDCAB] = 590 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 591 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 592 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 593 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 594 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 595 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 596 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 597 then 'KC SAMANHUDI' 
                                                WHEN [FKDCAB] = 598 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 599 then 'KC SAMANHUDI'
                                                WHEN [FKDCAB] = 600 then 'KC SAMANHUDI'
                                                end as [CABANG_INDUK]
                                            ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                                    WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                                    WHEN [FKDCAB] = 001 then 'KCU JATINEGARA'
                                                    WHEN [FKDCAB] = 002 then 'KCU MANGGA DUA'
                                                    WHEN [FKDCAB] = 003 then 'KCU SAMANHUDI'
                                                    WHEN [FKDCAB] = 004 then 'KCU SUNTER'
                                                    WHEN [FKDCAB] = 005 then 'KCU DHARMAWANGSA'
                                                    WHEN [FKDCAB] = 006 then 'KCP KENARI'
                                                    WHEN [FKDCAB] = 007 then 'KCP BEKASI'
                                                    WHEN [FKDCAB] = 008 then 'KCP KELAPA GADING'
                                                    WHEN [FKDCAB] = 009 then 'ULS TANAH ABANG'
                                                    WHEN [FKDCAB] = 010 then 'ULS MARGONDA DEPOK'
                                                    WHEN [FKDCAB] = 011 then 'ULS DARMO'
                                                    WHEN [FKDCAB] = 012 then 'ULS METRO PONDOK INDAH'
                                                    WHEN [FKDCAB] = 013 then 'ULS TANGERANG'
                                                    WHEN [FKDCAB] = 014 then 'ULS BOGOR'
                                                    WHEN [FKDCAB] = 015 then 'ULS VETERAN'
                                                    WHEN [FKDCAB] = 016 then 'ULS SIDOARJO'
                                                    WHEN [FKDCAB] = 017 then 'ULS PASAR MINGGU'
                                                    WHEN [FKDCAB] = 018 then 'ULS CIMANGGIS'
                                                    WHEN [FKDCAB] = 019 then 'ULS TANJUNG PRIOK'
                                                    WHEN [FKDCAB] = 020 then 'ULS KAPAS KERAMPUNG'
                                                    WHEN [FKDCAB] = 021 then 'ULS PONDOK CHANDRA'
                                                    WHEN [FKDCAB] = 022 then 'ULS SEPANJANG'
                                                    WHEN [FKDCAB] = 023 then 'ULS MELAWAI'
                                                    WHEN [FKDCAB] = 024 then 'ULS GUDANG PELURU'
                                                    WHEN [FKDCAB] = 025 then 'ULS KEMANG MANSION'
                                                    WHEN [FKDCAB] = 026 then 'KCP KRANJI BEKASI'
                                                    WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR'
                                                    WHEN [FKDCAB] = 028 then 'KCP CILEDUG TANGERANG'
                                                    WHEN [FKDCAB] = 029 then 'ULS PERAK BARAT'
                                                    WHEN [FKDCAB] = 030 then 'KCU SEMARANG'
                                                    WHEN [FKDCAB] = 031 then 'ULS JUANDA BEKASI'
                                                    WHEN [FKDCAB] = 032 then 'ULS GEDANGAN'
                                                    WHEN [FKDCAB] = 033 then 'ULS GRESIK'
                                                    WHEN [FKDCAB] = 034 then 'ULS MAJAPAHIT'
                                                    WHEN [FKDCAB] = 035 then 'KCU BANDUNG'
                                                    WHEN [FKDCAB] = 036 then 'ULS PURI INDAH'
                                                    WHEN [FKDCAB] = 037 then 'KCU SOLO'
                                                    WHEN [FKDCAB] = 038 then 'KCP PONDOK GEDE'
                                                    WHEN [FKDCAB] = 039 then 'KCP CIBINONG'
                                                    WHEN [FKDCAB] = 040 then 'KCP CIKARANG SELATAN'
                                                    WHEN [FKDCAB] = 041 then 'KCP TANGERANG KOTA'
                                                    WHEN [FKDCAB] = 042 then 'KCP CIPUTAT'
                                                    WHEN [FKDCAB] = 043 then 'KCP DEPOK'
                                                    WHEN [FKDCAB] = 044 then 'KCP CILEUNGSI'
                                                    WHEN [FKDCAB] = 045 then 'KCP CIKARANG UTARA'
                                                    WHEN [FKDCAB] = 046 then 'KCU YOGYAKARTA'
                                                    WHEN [FKDCAB] = 047 then 'ULS PLUIT KENCANA'
                                                    WHEN [FKDCAB] = 048 then 'ULS SOLO SLAMET RIYADI'
                                                    WHEN [FKDCAB] = 049 then 'ULS DAGO'
                                                    WHEN [FKDCAB] = 050 then 'KCU MEDAN'
                                                    WHEN [FKDCAB] = 051 then 'ULS BINTARO'
                                                    WHEN [FKDCAB] = 052 then 'KCU PALEMBANG'
                                                    WHEN [FKDCAB] = 053 then 'KCP MALANG'
                                                    WHEN [FKDCAB] = 054 then 'ULS KOTABARU PARAHYANGAN'
                                                    WHEN [FKDCAB] = 055 then 'ULS SUDIRMAN'
                                                    WHEN [FKDCAB] = 056 then 'ULS KUDUS'
                                                    WHEN [FKDCAB] = 057 then 'ULS PEMUDA'
                                                    WHEN [FKDCAB] = 058 then 'ULS PANDAAN'
                                                    WHEN [FKDCAB] = 059 then 'ULS BUAH BATU'
                                                    WHEN [FKDCAB] = 060 then 'ULS SINGOSAREN'
                                                    WHEN [FKDCAB] = 061 then 'ULS SRAGEN'
                                                    WHEN [FKDCAB] = 062 then 'ULS MOJOKERTO'
                                                    WHEN [FKDCAB] = 063 then 'ULS KEPANJEN'
                                                    WHEN [FKDCAB] = 064 then 'ULS AHMAD RIFAI'
                                                    WHEN [FKDCAB] = 065 then 'ULS BINTARO'
                                                    WHEN [FKDCAB] = 066 then 'KCU BANDAR LAMPUNG'
                                                    WHEN [FKDCAB] = 067 then 'KCU BANDA ACEH'
                                                    WHEN [FKDCAB] = 068 then 'KCP KEDIRI'
                                                    WHEN [FKDCAB] = 069 then 'ULS SETIABUDI'
                                                    WHEN [FKDCAB] = 070 then 'KCP PASURUAN'
                                                    WHEN [FKDCAB] = 071 then 'KCU PANAKKUKANG'
                                                    WHEN [FKDCAB] = 072 then 'KCP LHOKSEUMAWE'
                                                    WHEN [FKDCAB] = 073 then 'ULS BIREUN'
                                                    WHEN [FKDCAB] = 074 then 'ULS TAMAN PONDOK INDAH'
                                                    WHEN [FKDCAB] = 075 then 'ULS SUDIRMAN PALEMBANG'
                                                    WHEN [FKDCAB] = 076 then 'KCP BANYUWANGI'
                                                    WHEN [FKDCAB] = 501 then 'LSBU BEKASI'
                                                    WHEN [FKDCAB] = 502 then 'LSBU CIBUBUR'
                                                    WHEN [FKDCAB] = 503 then 'LSBU KARAWANG'
                                                    WHEN [FKDCAB] = 504 then 'LSBU BANGKALAN'
                                                    WHEN [FKDCAB] = 505 then 'LSBU TUBAN'
                                                    WHEN [FKDCAB] = 506 then 'LSBU BABAT'
                                                    WHEN [FKDCAB] = 507 then 'LSBU PAMEKASAN'
                                                    WHEN [FKDCAB] = 508 then 'LSBU SAMPANG'
                                                    WHEN [FKDCAB] = 521 then 'LSBU CIREBON' 
                                                    WHEN [FKDCAB] = 522 then 'LSBU GARUT' 
                                                    WHEN [FKDCAB] = 523 then 'LSBU SUKABUMI' 
                                                    WHEN [FKDCAB] = 524 then 'LSBU TASIKMALAYA' 
                                                    WHEN [FKDCAB] = 525 then 'LSBU CIANJUR' 
                                                    WHEN [FKDCAB] = 526 then 'LSBU SUBANG' 
                                                    WHEN [FKDCAB] = 527 then 'LSBU PURWAKARTA' 
                                                    WHEN [FKDCAB] = 528 then 'LSBU INDRAMAYU' 
                                                    WHEN [FKDCAB] = 529 then 'LSBU JATIWANGI' 
                                                    WHEN [FKDCAB] = 530 then 'LSBU CIAMIS' 
                                                    WHEN [FKDCAB] = 531 then 'LSBU KUNINGAN CIREBON' 
                                                    WHEN [FKDCAB] = 532 then 'LSBU CIBADAK' 
                                                    WHEN [FKDCAB] = 533 then 'LSBU SUMEDANG' 
                                                    WHEN [FKDCAB] = 509 then 'LSBU PROBOLINGGO' 
                                                    WHEN [FKDCAB] = 510 then 'LSBU SITUBONDO' 
                                                    WHEN [FKDCAB] = 511 then 'LSBU TULUNGAGUNG' 
                                                    WHEN [FKDCAB] = 512 then 'LSBU BLITAR' 
                                                    WHEN [FKDCAB] = 513 then 'LSBU MADIUN' 
                                                    WHEN [FKDCAB] = 514 then 'LSBU PASURUAN' 
                                                    WHEN [FKDCAB] = 515 then 'LSBU KERTOSONO' 
                                                    WHEN [FKDCAB] = 516 then 'LSBU BANYUWANGI' 
                                                    WHEN [FKDCAB] = 517 then 'LSBU BONDOWOSO' 
                                                    WHEN [FKDCAB] = 518 then 'LSBU LUMAJANG' 
                                                    WHEN [FKDCAB] = 519 then 'LSBU MAGETAN' 
                                                    WHEN [FKDCAB] = 520 then 'LSBU NGAWI' 
                                                    WHEN [FKDCAB] = 534 then 'LSBU PURWOKERTO' 
                                                    WHEN [FKDCAB] = 535 then 'LSBU CILACAP' 
                                                    WHEN [FKDCAB] = 536 then 'LSBU PURWODADI' 
                                                    WHEN [FKDCAB] = 537 then 'LSBU MAGELANG' 
                                                    WHEN [FKDCAB] = 538 then 'LSBU PEKALONGAN' 
                                                    WHEN [FKDCAB] = 539 then 'LSBU SALATIGA' 
                                                    WHEN [FKDCAB] = 540 then 'LSBU TEGAL' 
                                                    WHEN [FKDCAB] = 541 then 'LSBU BANJARNEGARA' 
                                                    WHEN [FKDCAB] = 542 then 'LSBU WONOSOBO' 
                                                    WHEN [FKDCAB] = 543 then 'LSBU WONOGIRI' 
                                                    WHEN [FKDCAB] = 544 then 'LSBU PARAKAN' 
                                                    WHEN [FKDCAB] = 545 then 'LSBU JEPARA' 
                                                    WHEN [FKDCAB] = 546 then 'LSBU KEDUNGWUNI' 
                                                    WHEN [FKDCAB] = 547 then 'LSBU KUTUARJO' 
                                                    WHEN [FKDCAB] = 548 then 'LSBU BOYOLALI' 
                                                    WHEN [FKDCAB] = 549 then 'LSBU PURBALINGGA' 
                                                    WHEN [FKDCAB] = 550 then 'LSBU GOMBONG' 
                                                    WHEN [FKDCAB] = 551 then 'LSBU BLOK A CIPETE'
                                                    WHEN [FKDCAB] = 552 then 'LSBU CITY TOWER'
                                                    WHEN [FKDCAB] = 553 then 'LSBU KEBAYORAN BARU'
                                                    WHEN [FKDCAB] = 554 then 'LSBU KUNINGAN'
                                                    WHEN [FKDCAB] = 555 then 'LSBU MENARA BIDAKARA'
                                                    WHEN [FKDCAB] = 556 then 'LSBU PONDOK INDAH'
                                                    WHEN [FKDCAB] = 557 then 'LSBU SCBD'
                                                    WHEN [FKDCAB] = 558 then 'LSBU SUDIRMAN'
                                                    WHEN [FKDCAB] = 559 then 'LSBU THAMRIN'
                                                    WHEN [FKDCAB] = 560 then 'LSBU FATMAWATI'
                                                    WHEN [FKDCAB] = 561 then 'LSBU SABANG'
                                                    WHEN [FKDCAB] = 562 then 'LSBU MENTENG'
                                                    WHEN [FKDCAB] = 563 then 'LSBU PERMATA HIJAU'
                                                    WHEN [FKDCAB] = 564 then 'LSBU KEMANG'
                                                    WHEN [FKDCAB] = 565 then 'LSBU WARUNG BUNCIT'
                                                    WHEN [FKDCAB] = 566 then 'LSBU SANTA'
                                                    WHEN [FKDCAB] = 567 then 'LSBU GUNSA 45'
                                                    WHEN [FKDCAB] = 568 then 'LSBU KALIMALANG'
                                                    WHEN [FKDCAB] = 569 then 'LSBU KELAPA GADING'
                                                    WHEN [FKDCAB] = 570 then 'LSBU MATRAMAN'
                                                    WHEN [FKDCAB] = 571 then 'LSBU RAWAMANGUN'
                                                    WHEN [FKDCAB] = 572 then 'LSBU SUNTER'
                                                    WHEN [FKDCAB] = 573 then 'LSBU WISMA MILLENIA'
                                                    WHEN [FKDCAB] = 574 then 'LSBU SILIWANGI'
                                                    WHEN [FKDCAB] = 575 then 'LSBU CEMPAKA  PUTIH RAYA'
                                                    WHEN [FKDCAB] = 576 then 'LSBU SUNTER  AGUNG'
                                                    WHEN [FKDCAB] = 577 then 'LSBU DEWI SARTIKA'
                                                    WHEN [FKDCAB] = 578 then 'LSBU ASEMKA'
                                                    WHEN [FKDCAB] = 579 then 'LSBU GAJAH MADA'
                                                    WHEN [FKDCAB] = 580 then 'LSBU MANGGA DUA RAYA'
                                                    WHEN [FKDCAB] = 581 then 'LSBU MUARA KARANG'
                                                    WHEN [FKDCAB] = 582 then 'LSBU PANGERAN JAYAKARTA'
                                                    WHEN [FKDCAB] = 583 then 'LSBU PANTAI INDAH KAPUK'
                                                    WHEN [FKDCAB] = 584 then 'LSBU PASAR BARU'
                                                    WHEN [FKDCAB] = 585 then 'LSBU PLUIT'
                                                    WHEN [FKDCAB] = 586 then 'LSBU SURYOPRANOTO'
                                                    WHEN [FKDCAB] = 587 then 'LSBU TAMAN DUTA MAS'
                                                    WHEN [FKDCAB] = 588 then 'LSBU KHM MANSYUR'
                                                    WHEN [FKDCAB] = 589 then 'LSBU GROGOL MUWARDI'
                                                    WHEN [FKDCAB] = 590 then 'LSBU DAAN MOGOT'
                                                    WHEN [FKDCAB] = 591 then 'LSBU GREEN GARDEN'
                                                    WHEN [FKDCAB] = 592 then 'LSBU KEDOYA PERMAI'
                                                    WHEN [FKDCAB] = 593 then 'LSBU PURI INDAH'
                                                    WHEN [FKDCAB] = 594 then 'LSBU WAHID HASYIM'
                                                    WHEN [FKDCAB] = 595 then 'LSBU WISMA ASIA'
                                                    WHEN [FKDCAB] = 596 then 'LSBU KEPA DURI'
                                                    WHEN [FKDCAB] = 597 then 'LSBU KEBON JERUK' 
                                                    WHEN [FKDCAB] = 598 then 'LSBU METRO TANAH ABANG'
                                                    WHEN [FKDCAB] = 599 then 'LSBU KS TUBUN'
                                                    WHEN [FKDCAB] = 600 then 'LSBU TOMANG RAYA'
                                                    end as [NAMA_CABANG]
                                            ,CIF.[FKDCAB] as [KODE_CABANG]	
                                            ,CIF.[FCODE] as	[NOMOR_CIF]	
                                            ,CONVERT(Varchar(20),[FTGLINPUT],103) as	[TANGGAL_BUKA]	
                                            ,CIF.[FNAMA] as	[NAMA_SESUAI_IDENTITAS]
                                            ,CIF.[FREPNAME] as	[NAMA_TANPA_SINGKATAN]
                                            ,CASE WHEN CIF.[FKODEID] = 1 THEN 'KTP'
                                                WHEN CIF.[FKODEID] = 2 THEN 'SIM' 
                                                WHEN CIF.[FKODEID] = 3 THEN 'PASSPORT'
                                                WHEN CIF.[FKODEID] = 5 THEN 'KITAS'
                                                WHEN CIF.[FKODEID] = 7 THEN 'NIK/KK'
                                                WHEN CIF.[FKODEID] = 8 THEN 'AKTE KELAHIRAN'
                                                WHEN CIF.[FKODEID] = 9 THEN 'NIS / NISN'
                                                WHEN CIF.[FKODEID] = 10 THEN 'PERKUMPULAN NON FORMAL'
                                                END AS [JENIS_IDENTITAS] 			
                                            ,CIF.[FNOMORID] as	[NOMOR_IDENTITAS]
                                            ,len (CIF.[FNOMORID]) as [DIGIT_ID]
                                            ,CIF.[FUSID] as [USER_INPUT]
                                            ,CIF.[FAUTO] as [USER_OTOR]
                                            ,CONVERT(Varchar(20),[FTGLAUTO],103) as [TGL_OTOR]
                                            ,CONVERT(Varchar(20),[FTGLUBAH],103) as [TGL_PERUBAHAN]
                                            ,CIF.[FJAMUBAH] as [JAM_PERUBAHAN]
                                            ,CASE WHEN CIF.[FJNSNSB] = 'I' THEN 'INDIVIDU'
                                                WHEN CIF.[FJNSNSB] = 'C' THEN 'KORPORASI'
                                                END AS [JENIS_NASABAH]
                                            ,CASE WHEN CIF.[FSTATUS] = 1 THEN 'AKTIF'
                                                WHEN CIF.[FSTATUS] = 0 THEN 'TIDAK AKTIF'
                                                END AS [STATUS]	
                                            ,CIF.[PERIODE]
                                            FROM [BCAS_MIS].[dbo].[CIF] WITH (NOLOCK)
                                        WHERE CIF.FJNSNSB = 'I' 
                                        and [FSTATUS] = 1
                                        and CIF.[FKODEID] = 1 
                                        and 
                                            (CIF.[FNOMORID] = ''
                                            or len (CIF.[FNOMORID]) <> 16 
                                            or CIF.[FNOMORID] like '%-%'
                                            or CIF.[FNOMORID] like '%.%'
                                            or CIF.[FNOMORID] like '%[a-b-c-d-e-f-g-h-i-j-k-l-m-n-o-p-q-r-s-t-u-v-w-x-y-z]%'
                                            or CIF.[FNOMORID] = ''
                                            or CIF.[FNOMORID] like '%/%')
                                        and FKDCAB = '$cabang'
                                        and CIF.[FTGLINPUT] between '$tgl_input' and '$tgl_inputakhir'
                                        and [PERIODE] = '$periode'
                                        -- order by CIF.[FTGLINPUT] desc
                                    ) as a")->result();
        
        return $dataNik;
    }

    public function Anomalinpwp($cabang,$tgl_input,$tgl_inputakhir,$periode)
    {
        $dataNpwp  = $this->db->query("SELECT * FROM (
                            SELECT ROW_NUMBER() OVER(order by PERIODE DESC) as NO
                                    ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                        WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                        WHEN [FKDCAB] = 001 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 002 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 003 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 004 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 005 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 006 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 007 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 008 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 009 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 010 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 011 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 012 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 013 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 014 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 015 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 016 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 017 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 018 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 019 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 020 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 021 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 022 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 023 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 024 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 025 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 026 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR BOGOR (TUTUP)'
                                        WHEN [FKDCAB] = 028 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 029 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 030 then 'KC SEMARANG'
                                        WHEN [FKDCAB] = 031 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 032 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 033 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 034 then 'KC SEMARANG'
                                        WHEN [FKDCAB] = 035 then 'KC BANDUNG'
                                        WHEN [FKDCAB] = 036 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 037 then 'KC SOLO'
                                        WHEN [FKDCAB] = 038 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 039 then 'KF BUR CIBINONG (TUTUP)'
                                        WHEN [FKDCAB] = 040 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 041 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 042 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 043 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 044 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 045 then 'KF BUR CIKARANG UTARA (TUTUP)'
                                        WHEN [FKDCAB] = 046 then 'KC YOGYAKARTA'
                                        WHEN [FKDCAB] = 047 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 048 then 'KC SOLO'
                                        WHEN [FKDCAB] = 049 then 'KC BANDUNG'
                                        WHEN [FKDCAB] = 050 then 'KC MEDAN'
                                        WHEN [FKDCAB] = 051 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 052 then 'KC PALEMBANG'
                                        WHEN [FKDCAB] = 053 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 054 then 'KC BANDUNG'
                                        WHEN [FKDCAB] = 055 then 'KC YOGYAKARTA'
                                        WHEN [FKDCAB] = 056 then 'KC SEMARANG'
                                        WHEN [FKDCAB] = 057 then 'KC SEMARANG'
                                        WHEN [FKDCAB] = 058 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 059 then 'KC BANDUNG'
                                        WHEN [FKDCAB] = 060 then 'KC SOLO'
                                        WHEN [FKDCAB] = 061 then 'KC SOLO'
                                        WHEN [FKDCAB] = 062 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 063 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 064 then 'KC PALEMBANG'
                                        WHEN [FKDCAB] = 065 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 066 then 'KC BANDAR LAMPUNG'
                                        WHEN [FKDCAB] = 067 then 'KC BANDA ACEH'
                                        WHEN [FKDCAB] = 068 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 069 then 'KC MEDAN'
                                        WHEN [FKDCAB] = 070 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 071 then 'KC PANAKKUKANG'
                                        WHEN [FKDCAB] = 072 then 'KC BANDA ACEH'
                                        WHEN [FKDCAB] = 073 then 'KC BANDA ACEH'
                                        WHEN [FKDCAB] = 074 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 075 then 'KC PALEMBANG'
                                        WHEN [FKDCAB] = 076 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 501 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 502 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 503 then 'KC BANDUNG'
                                        WHEN [FKDCAB] = 504 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 505 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 506 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 507 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 508 then 'KC SURABAYA'
                                        WHEN [FKDCAB] = 521 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 522 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 523 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 524 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 525 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 526 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 527 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 528 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 529 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 530 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 531 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 532 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 533 then 'KC BANDUNG' 
                                        WHEN [FKDCAB] = 509 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 510 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 511 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 512 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 513 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 514 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 515 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 516 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 517 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 518 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 519 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 520 then 'KC SURABAYA' 
                                        WHEN [FKDCAB] = 534 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 535 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 536 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 537 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 538 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 539 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 540 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 541 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 542 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 543 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 544 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 545 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 546 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 547 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 548 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 549 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 550 then 'KC SEMARANG' 
                                        WHEN [FKDCAB] = 551 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 552 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 553 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 554 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 555 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 556 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 557 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 558 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 559 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 560 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 561 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 562 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 563 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 564 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 565 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 566 then 'KC MANGGA DUA'
                                        WHEN [FKDCAB] = 567 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 568 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 569 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 570 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 571 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 572 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 573 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 574 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 575 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 576 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 577 then 'KC JATINEGARA'
                                        WHEN [FKDCAB] = 578 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 579 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 580 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 581 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 582 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 583 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 584 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 585 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 586 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 587 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 588 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 589 then 'KC SUNTER'
                                        WHEN [FKDCAB] = 590 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 591 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 592 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 593 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 594 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 595 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 596 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 597 then 'KC SAMANHUDI' 
                                        WHEN [FKDCAB] = 598 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 599 then 'KC SAMANHUDI'
                                        WHEN [FKDCAB] = 600 then 'KC SAMANHUDI'
                                        end as [CABANG_INDUK]
                                    ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                            WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                            WHEN [FKDCAB] = 001 then 'KCU JATINEGARA'
                                            WHEN [FKDCAB] = 002 then 'KCU MANGGA DUA'
                                            WHEN [FKDCAB] = 003 then 'KCU SAMANHUDI'
                                            WHEN [FKDCAB] = 004 then 'KCU SUNTER'
                                            WHEN [FKDCAB] = 005 then 'KCU DHARMAWANGSA'
                                            WHEN [FKDCAB] = 006 then 'KCP KENARI'
                                            WHEN [FKDCAB] = 007 then 'KCP BEKASI'
                                            WHEN [FKDCAB] = 008 then 'KCP KELAPA GADING'
                                            WHEN [FKDCAB] = 009 then 'ULS TANAH ABANG'
                                            WHEN [FKDCAB] = 010 then 'ULS MARGONDA DEPOK'
                                            WHEN [FKDCAB] = 011 then 'ULS DARMO'
                                            WHEN [FKDCAB] = 012 then 'ULS METRO PONDOK INDAH'
                                            WHEN [FKDCAB] = 013 then 'ULS TANGERANG'
                                            WHEN [FKDCAB] = 014 then 'ULS BOGOR'
                                            WHEN [FKDCAB] = 015 then 'ULS VETERAN'
                                            WHEN [FKDCAB] = 016 then 'ULS SIDOARJO'
                                            WHEN [FKDCAB] = 017 then 'ULS PASAR MINGGU'
                                            WHEN [FKDCAB] = 018 then 'ULS CIMANGGIS'
                                            WHEN [FKDCAB] = 019 then 'ULS TANJUNG PRIOK'
                                            WHEN [FKDCAB] = 020 then 'ULS KAPAS KERAMPUNG'
                                            WHEN [FKDCAB] = 021 then 'ULS PONDOK CHANDRA'
                                            WHEN [FKDCAB] = 022 then 'ULS SEPANJANG'
                                            WHEN [FKDCAB] = 023 then 'ULS MELAWAI'
                                            WHEN [FKDCAB] = 024 then 'ULS GUDANG PELURU'
                                            WHEN [FKDCAB] = 025 then 'ULS KEMANG MANSION'
                                            WHEN [FKDCAB] = 026 then 'KCP KRANJI BEKASI'
                                            WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR'
                                            WHEN [FKDCAB] = 028 then 'KCP CILEDUG TANGERANG'
                                            WHEN [FKDCAB] = 029 then 'ULS PERAK BARAT'
                                            WHEN [FKDCAB] = 030 then 'KCU SEMARANG'
                                            WHEN [FKDCAB] = 031 then 'ULS JUANDA BEKASI'
                                            WHEN [FKDCAB] = 032 then 'ULS GEDANGAN'
                                            WHEN [FKDCAB] = 033 then 'ULS GRESIK'
                                            WHEN [FKDCAB] = 034 then 'ULS MAJAPAHIT'
                                            WHEN [FKDCAB] = 035 then 'KCU BANDUNG'
                                            WHEN [FKDCAB] = 036 then 'ULS PURI INDAH'
                                            WHEN [FKDCAB] = 037 then 'KCU SOLO'
                                            WHEN [FKDCAB] = 038 then 'KCP PONDOK GEDE'
                                            WHEN [FKDCAB] = 039 then 'KCP CIBINONG'
                                            WHEN [FKDCAB] = 040 then 'KCP CIKARANG SELATAN'
                                            WHEN [FKDCAB] = 041 then 'KCP TANGERANG KOTA'
                                            WHEN [FKDCAB] = 042 then 'KCP CIPUTAT'
                                            WHEN [FKDCAB] = 043 then 'KCP DEPOK'
                                            WHEN [FKDCAB] = 044 then 'KCP CILEUNGSI'
                                            WHEN [FKDCAB] = 045 then 'KCP CIKARANG UTARA'
                                            WHEN [FKDCAB] = 046 then 'KCU YOGYAKARTA'
                                            WHEN [FKDCAB] = 047 then 'ULS PLUIT KENCANA'
                                            WHEN [FKDCAB] = 048 then 'ULS SOLO SLAMET RIYADI'
                                            WHEN [FKDCAB] = 049 then 'ULS DAGO'
                                            WHEN [FKDCAB] = 050 then 'KCU MEDAN'
                                            WHEN [FKDCAB] = 051 then 'ULS BINTARO'
                                            WHEN [FKDCAB] = 052 then 'KCU PALEMBANG'
                                            WHEN [FKDCAB] = 053 then 'KCP MALANG'
                                            WHEN [FKDCAB] = 054 then 'ULS KOTABARU PARAHYANGAN'
                                            WHEN [FKDCAB] = 055 then 'ULS SUDIRMAN'
                                            WHEN [FKDCAB] = 056 then 'ULS KUDUS'
                                            WHEN [FKDCAB] = 057 then 'ULS PEMUDA'
                                            WHEN [FKDCAB] = 058 then 'ULS PANDAAN'
                                            WHEN [FKDCAB] = 059 then 'ULS BUAH BATU'
                                            WHEN [FKDCAB] = 060 then 'ULS SINGOSAREN'
                                            WHEN [FKDCAB] = 061 then 'ULS SRAGEN'
                                            WHEN [FKDCAB] = 062 then 'ULS MOJOKERTO'
                                            WHEN [FKDCAB] = 063 then 'ULS KEPANJEN'
                                            WHEN [FKDCAB] = 064 then 'ULS AHMAD RIFAI'
                                            WHEN [FKDCAB] = 065 then 'ULS BINTARO'
                                            WHEN [FKDCAB] = 066 then 'KCU BANDAR LAMPUNG'
                                            WHEN [FKDCAB] = 067 then 'KCU BANDA ACEH'
                                            WHEN [FKDCAB] = 068 then 'KCP KEDIRI'
                                            WHEN [FKDCAB] = 069 then 'ULS SETIABUDI'
                                            WHEN [FKDCAB] = 070 then 'KCP PASURUAN'
                                            WHEN [FKDCAB] = 071 then 'KCU PANAKKUKANG'
                                            WHEN [FKDCAB] = 072 then 'KCP LHOKSEUMAWE'
                                            WHEN [FKDCAB] = 073 then 'ULS BIREUN'
                                            WHEN [FKDCAB] = 074 then 'ULS TAMAN PONDOK INDAH'
                                            WHEN [FKDCAB] = 075 then 'ULS SUDIRMAN PALEMBANG'
                                            WHEN [FKDCAB] = 076 then 'KCP BANYUWANGI'
                                            WHEN [FKDCAB] = 501 then 'LSBU BEKASI'
                                            WHEN [FKDCAB] = 502 then 'LSBU CIBUBUR'
                                            WHEN [FKDCAB] = 503 then 'LSBU KARAWANG'
                                            WHEN [FKDCAB] = 504 then 'LSBU BANGKALAN'
                                            WHEN [FKDCAB] = 505 then 'LSBU TUBAN'
                                            WHEN [FKDCAB] = 506 then 'LSBU BABAT'
                                            WHEN [FKDCAB] = 507 then 'LSBU PAMEKASAN'
                                            WHEN [FKDCAB] = 508 then 'LSBU SAMPANG'
                                            WHEN [FKDCAB] = 521 then 'LSBU CIREBON' 
                                            WHEN [FKDCAB] = 522 then 'LSBU GARUT' 
                                            WHEN [FKDCAB] = 523 then 'LSBU SUKABUMI' 
                                            WHEN [FKDCAB] = 524 then 'LSBU TASIKMALAYA' 
                                            WHEN [FKDCAB] = 525 then 'LSBU CIANJUR' 
                                            WHEN [FKDCAB] = 526 then 'LSBU SUBANG' 
                                            WHEN [FKDCAB] = 527 then 'LSBU PURWAKARTA' 
                                            WHEN [FKDCAB] = 528 then 'LSBU INDRAMAYU' 
                                            WHEN [FKDCAB] = 529 then 'LSBU JATIWANGI' 
                                            WHEN [FKDCAB] = 530 then 'LSBU CIAMIS' 
                                            WHEN [FKDCAB] = 531 then 'LSBU KUNINGAN CIREBON' 
                                            WHEN [FKDCAB] = 532 then 'LSBU CIBADAK' 
                                            WHEN [FKDCAB] = 533 then 'LSBU SUMEDANG' 
                                            WHEN [FKDCAB] = 509 then 'LSBU PROBOLINGGO' 
                                            WHEN [FKDCAB] = 510 then 'LSBU SITUBONDO' 
                                            WHEN [FKDCAB] = 511 then 'LSBU TULUNGAGUNG' 
                                            WHEN [FKDCAB] = 512 then 'LSBU BLITAR' 
                                            WHEN [FKDCAB] = 513 then 'LSBU MADIUN' 
                                            WHEN [FKDCAB] = 514 then 'LSBU PASURUAN' 
                                            WHEN [FKDCAB] = 515 then 'LSBU KERTOSONO' 
                                            WHEN [FKDCAB] = 516 then 'LSBU BANYUWANGI' 
                                            WHEN [FKDCAB] = 517 then 'LSBU BONDOWOSO' 
                                            WHEN [FKDCAB] = 518 then 'LSBU LUMAJANG' 
                                            WHEN [FKDCAB] = 519 then 'LSBU MAGETAN' 
                                            WHEN [FKDCAB] = 520 then 'LSBU NGAWI' 
                                            WHEN [FKDCAB] = 534 then 'LSBU PURWOKERTO' 
                                            WHEN [FKDCAB] = 535 then 'LSBU CILACAP' 
                                            WHEN [FKDCAB] = 536 then 'LSBU PURWODADI' 
                                            WHEN [FKDCAB] = 537 then 'LSBU MAGELANG' 
                                            WHEN [FKDCAB] = 538 then 'LSBU PEKALONGAN' 
                                            WHEN [FKDCAB] = 539 then 'LSBU SALATIGA' 
                                            WHEN [FKDCAB] = 540 then 'LSBU TEGAL' 
                                            WHEN [FKDCAB] = 541 then 'LSBU BANJARNEGARA' 
                                            WHEN [FKDCAB] = 542 then 'LSBU WONOSOBO' 
                                            WHEN [FKDCAB] = 543 then 'LSBU WONOGIRI' 
                                            WHEN [FKDCAB] = 544 then 'LSBU PARAKAN' 
                                            WHEN [FKDCAB] = 545 then 'LSBU JEPARA' 
                                            WHEN [FKDCAB] = 546 then 'LSBU KEDUNGWUNI' 
                                            WHEN [FKDCAB] = 547 then 'LSBU KUTUARJO' 
                                            WHEN [FKDCAB] = 548 then 'LSBU BOYOLALI' 
                                            WHEN [FKDCAB] = 549 then 'LSBU PURBALINGGA' 
                                            WHEN [FKDCAB] = 550 then 'LSBU GOMBONG' 
                                            WHEN [FKDCAB] = 551 then 'LSBU BLOK A CIPETE'
                                            WHEN [FKDCAB] = 552 then 'LSBU CITY TOWER'
                                            WHEN [FKDCAB] = 553 then 'LSBU KEBAYORAN BARU'
                                            WHEN [FKDCAB] = 554 then 'LSBU KUNINGAN'
                                            WHEN [FKDCAB] = 555 then 'LSBU MENARA BIDAKARA'
                                            WHEN [FKDCAB] = 556 then 'LSBU PONDOK INDAH'
                                            WHEN [FKDCAB] = 557 then 'LSBU SCBD'
                                            WHEN [FKDCAB] = 558 then 'LSBU SUDIRMAN'
                                            WHEN [FKDCAB] = 559 then 'LSBU THAMRIN'
                                            WHEN [FKDCAB] = 560 then 'LSBU FATMAWATI'
                                            WHEN [FKDCAB] = 561 then 'LSBU SABANG'
                                            WHEN [FKDCAB] = 562 then 'LSBU MENTENG'
                                            WHEN [FKDCAB] = 563 then 'LSBU PERMATA HIJAU'
                                            WHEN [FKDCAB] = 564 then 'LSBU KEMANG'
                                            WHEN [FKDCAB] = 565 then 'LSBU WARUNG BUNCIT'
                                            WHEN [FKDCAB] = 566 then 'LSBU SANTA'
                                            WHEN [FKDCAB] = 567 then 'LSBU GUNSA 45'
                                            WHEN [FKDCAB] = 568 then 'LSBU KALIMALANG'
                                            WHEN [FKDCAB] = 569 then 'LSBU KELAPA GADING'
                                            WHEN [FKDCAB] = 570 then 'LSBU MATRAMAN'
                                            WHEN [FKDCAB] = 571 then 'LSBU RAWAMANGUN'
                                            WHEN [FKDCAB] = 572 then 'LSBU SUNTER'
                                            WHEN [FKDCAB] = 573 then 'LSBU WISMA MILLENIA'
                                            WHEN [FKDCAB] = 574 then 'LSBU SILIWANGI'
                                            WHEN [FKDCAB] = 575 then 'LSBU CEMPAKA  PUTIH RAYA'
                                            WHEN [FKDCAB] = 576 then 'LSBU SUNTER  AGUNG'
                                            WHEN [FKDCAB] = 577 then 'LSBU DEWI SARTIKA'
                                            WHEN [FKDCAB] = 578 then 'LSBU ASEMKA'
                                            WHEN [FKDCAB] = 579 then 'LSBU GAJAH MADA'
                                            WHEN [FKDCAB] = 580 then 'LSBU MANGGA DUA RAYA'
                                            WHEN [FKDCAB] = 581 then 'LSBU MUARA KARANG'
                                            WHEN [FKDCAB] = 582 then 'LSBU PANGERAN JAYAKARTA'
                                            WHEN [FKDCAB] = 583 then 'LSBU PANTAI INDAH KAPUK'
                                            WHEN [FKDCAB] = 584 then 'LSBU PASAR BARU'
                                            WHEN [FKDCAB] = 585 then 'LSBU PLUIT'
                                            WHEN [FKDCAB] = 586 then 'LSBU SURYOPRANOTO'
                                            WHEN [FKDCAB] = 587 then 'LSBU TAMAN DUTA MAS'
                                            WHEN [FKDCAB] = 588 then 'LSBU KHM MANSYUR'
                                            WHEN [FKDCAB] = 589 then 'LSBU GROGOL MUWARDI'
                                            WHEN [FKDCAB] = 590 then 'LSBU DAAN MOGOT'
                                            WHEN [FKDCAB] = 591 then 'LSBU GREEN GARDEN'
                                            WHEN [FKDCAB] = 592 then 'LSBU KEDOYA PERMAI'
                                            WHEN [FKDCAB] = 593 then 'LSBU PURI INDAH'
                                            WHEN [FKDCAB] = 594 then 'LSBU WAHID HASYIM'
                                            WHEN [FKDCAB] = 595 then 'LSBU WISMA ASIA'
                                            WHEN [FKDCAB] = 596 then 'LSBU KEPA DURI'
                                            WHEN [FKDCAB] = 597 then 'LSBU KEBON JERUK' 
                                            WHEN [FKDCAB] = 598 then 'LSBU METRO TANAH ABANG'
                                            WHEN [FKDCAB] = 599 then 'LSBU KS TUBUN'
                                            WHEN [FKDCAB] = 600 then 'LSBU TOMANG RAYA'
                                            end as [NAMA_CABANG]
                                    ,CIF.[FKDCAB] as [KODE_CABANG]	
                                    ,CIF.[FCODE] as	[NOMOR_CIF]	
                                    ,CONVERT(Varchar(20),[FTGLINPUT],103) as	[TANGGAL_BUKA]	
                                    ,CIF.[FNAMA] as	[NAMA_SESUAI_IDENTITAS]
                                    ,CIF.[FREPNAME] as	[NAMA_TANPA_SINGKATAN]
                                    ,CIF.[FNPWP] as	[NOMOR_NPWP]
                                    ,len (CIF.[FNPWP]) as [DIGIT_NPWP]
                                    ,CIF.[FUSID] as [USER_INPUT]
                                    ,CIF.[FAUTO] as [USER_OTOR]
                                    ,CONVERT(Varchar(20),[FTGLAUTO],103) as [TGL_OTOR]
                                    ,CONVERT(Varchar(20),[FTGLUBAH],103) as [TGL_PERUBAHAN]
                                    ,CIF.[FJAMUBAH] as [JAM_PERUBAHAN]
                                    ,CASE WHEN CIF.[FJNSNSB] = 'I' THEN 'INDIVIDU'
                                        WHEN CIF.[FJNSNSB] = 'C' THEN 'KORPORASI'
                                        END AS [JENIS_NASABAH]
                                    ,CASE WHEN CIF.[FSTATUS] = 1 THEN 'AKTIF'
                                        WHEN CIF.[FSTATUS] = 0 THEN 'TIDAK AKTIF'
                                        END AS [STATUS]	
                                    ,CIF.[PERIODE]
                                    FROM [BCAS_MIS].[dbo].[CIF] WITH (NOLOCK)
                                    WHERE CIF.FJNSNSB = 'I' 
                                and [FSTATUS] = 1 
                                and [FNPWP] not like '__.___.___._.___.___%'
                                and FNPWP not in ('99')
                                and PERIODE = '$periode'
                                and CIF.[FTGLINPUT] between '$tgl_input' and '$tgl_inputakhir'
                                -- and [FKDCAB] in (001,002)
                                and [FKDCAB] = '$cabang'
                            ) as a")->result();
        
        return $dataNpwp;
    }

    public function Anomaliumum($cabang,$tgl_input,$tgl_inputakhir,$periode)
    {
        $dataNpwp  = $this->db->query("SELECT * FROM (
                    SELECT ROW_NUMBER() OVER(order by PERIODE DESC) as NO
                        ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                            WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                            WHEN [FKDCAB] = 001 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 002 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 003 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 004 then 'KC SUNTER'
                            WHEN [FKDCAB] = 005 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 006 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 007 then 'KC SUNTER'
                            WHEN [FKDCAB] = 008 then 'KC SUNTER'
                            WHEN [FKDCAB] = 009 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 010 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 011 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 012 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 013 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 014 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 015 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 016 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 017 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 018 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 019 then 'KC SUNTER'
                            WHEN [FKDCAB] = 020 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 021 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 022 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 023 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 024 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 025 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 026 then 'KC SUNTER'
                            WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR BOGOR (TUTUP)'
                            WHEN [FKDCAB] = 028 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 029 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 030 then 'KC SEMARANG'
                            WHEN [FKDCAB] = 031 then 'KC SUNTER'
                            WHEN [FKDCAB] = 032 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 033 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 034 then 'KC SEMARANG'
                            WHEN [FKDCAB] = 035 then 'KC BANDUNG'
                            WHEN [FKDCAB] = 036 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 037 then 'KC SOLO'
                            WHEN [FKDCAB] = 038 then 'KC SUNTER'
                            WHEN [FKDCAB] = 039 then 'KF BUR CIBINONG (TUTUP)'
                            WHEN [FKDCAB] = 040 then 'KC SUNTER'
                            WHEN [FKDCAB] = 041 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 042 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 043 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 044 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 045 then 'KF BUR CIKARANG UTARA (TUTUP)'
                            WHEN [FKDCAB] = 046 then 'KC YOGYAKARTA'
                            WHEN [FKDCAB] = 047 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 048 then 'KC SOLO'
                            WHEN [FKDCAB] = 049 then 'KC BANDUNG'
                            WHEN [FKDCAB] = 050 then 'KC MEDAN'
                            WHEN [FKDCAB] = 051 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 052 then 'KC PALEMBANG'
                            WHEN [FKDCAB] = 053 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 054 then 'KC BANDUNG'
                            WHEN [FKDCAB] = 055 then 'KC YOGYAKARTA'
                            WHEN [FKDCAB] = 056 then 'KC SEMARANG'
                            WHEN [FKDCAB] = 057 then 'KC SEMARANG'
                            WHEN [FKDCAB] = 058 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 059 then 'KC BANDUNG'
                            WHEN [FKDCAB] = 060 then 'KC SOLO'
                            WHEN [FKDCAB] = 061 then 'KC SOLO'
                            WHEN [FKDCAB] = 062 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 063 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 064 then 'KC PALEMBANG'
                            WHEN [FKDCAB] = 065 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 066 then 'KC BANDAR LAMPUNG'
                            WHEN [FKDCAB] = 067 then 'KC BANDA ACEH'
                            WHEN [FKDCAB] = 068 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 069 then 'KC MEDAN'
                            WHEN [FKDCAB] = 070 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 071 then 'KC PANAKKUKANG'
                            WHEN [FKDCAB] = 072 then 'KC BANDA ACEH'
                            WHEN [FKDCAB] = 073 then 'KC BANDA ACEH'
                            WHEN [FKDCAB] = 074 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 075 then 'KC PALEMBANG'
                            WHEN [FKDCAB] = 076 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 501 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 502 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 503 then 'KC BANDUNG'
                            WHEN [FKDCAB] = 504 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 505 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 506 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 507 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 508 then 'KC SURABAYA'
                            WHEN [FKDCAB] = 521 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 522 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 523 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 524 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 525 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 526 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 527 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 528 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 529 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 530 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 531 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 532 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 533 then 'KC BANDUNG' 
                            WHEN [FKDCAB] = 509 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 510 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 511 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 512 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 513 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 514 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 515 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 516 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 517 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 518 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 519 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 520 then 'KC SURABAYA' 
                            WHEN [FKDCAB] = 534 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 535 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 536 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 537 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 538 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 539 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 540 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 541 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 542 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 543 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 544 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 545 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 546 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 547 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 548 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 549 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 550 then 'KC SEMARANG' 
                            WHEN [FKDCAB] = 551 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 552 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 553 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 554 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 555 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 556 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 557 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 558 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 559 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 560 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 561 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 562 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 563 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 564 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 565 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 566 then 'KC MANGGA DUA'
                            WHEN [FKDCAB] = 567 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 568 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 569 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 570 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 571 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 572 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 573 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 574 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 575 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 576 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 577 then 'KC JATINEGARA'
                            WHEN [FKDCAB] = 578 then 'KC SUNTER'
                            WHEN [FKDCAB] = 579 then 'KC SUNTER'
                            WHEN [FKDCAB] = 580 then 'KC SUNTER'
                            WHEN [FKDCAB] = 581 then 'KC SUNTER'
                            WHEN [FKDCAB] = 582 then 'KC SUNTER'
                            WHEN [FKDCAB] = 583 then 'KC SUNTER'
                            WHEN [FKDCAB] = 584 then 'KC SUNTER'
                            WHEN [FKDCAB] = 585 then 'KC SUNTER'
                            WHEN [FKDCAB] = 586 then 'KC SUNTER'
                            WHEN [FKDCAB] = 587 then 'KC SUNTER'
                            WHEN [FKDCAB] = 588 then 'KC SUNTER'
                            WHEN [FKDCAB] = 589 then 'KC SUNTER'
                            WHEN [FKDCAB] = 590 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 591 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 592 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 593 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 594 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 595 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 596 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 597 then 'KC SAMANHUDI' 
                            WHEN [FKDCAB] = 598 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 599 then 'KC SAMANHUDI'
                            WHEN [FKDCAB] = 600 then 'KC SAMANHUDI'
                            end as [CABANG_INDUK]
                        ,CASE WHEN [FKDCAB] = 000 then 'KANTOR PUSAT'
                                WHEN [FKDCAB] = 999 then 'KANTOR PUSAT'
                                WHEN [FKDCAB] = 001 then 'KCU JATINEGARA'
                                WHEN [FKDCAB] = 002 then 'KCU MANGGA DUA'
                                WHEN [FKDCAB] = 003 then 'KCU SAMANHUDI'
                                WHEN [FKDCAB] = 004 then 'KCU SUNTER'
                                WHEN [FKDCAB] = 005 then 'KCU DHARMAWANGSA'
                                WHEN [FKDCAB] = 006 then 'KCP KENARI'
                                WHEN [FKDCAB] = 007 then 'KCP BEKASI'
                                WHEN [FKDCAB] = 008 then 'KCP KELAPA GADING'
                                WHEN [FKDCAB] = 009 then 'ULS TANAH ABANG'
                                WHEN [FKDCAB] = 010 then 'ULS MARGONDA DEPOK'
                                WHEN [FKDCAB] = 011 then 'ULS DARMO'
                                WHEN [FKDCAB] = 012 then 'ULS METRO PONDOK INDAH'
                                WHEN [FKDCAB] = 013 then 'ULS TANGERANG'
                                WHEN [FKDCAB] = 014 then 'ULS BOGOR'
                                WHEN [FKDCAB] = 015 then 'ULS VETERAN'
                                WHEN [FKDCAB] = 016 then 'ULS SIDOARJO'
                                WHEN [FKDCAB] = 017 then 'ULS PASAR MINGGU'
                                WHEN [FKDCAB] = 018 then 'ULS CIMANGGIS'
                                WHEN [FKDCAB] = 019 then 'ULS TANJUNG PRIOK'
                                WHEN [FKDCAB] = 020 then 'ULS KAPAS KERAMPUNG'
                                WHEN [FKDCAB] = 021 then 'ULS PONDOK CHANDRA'
                                WHEN [FKDCAB] = 022 then 'ULS SEPANJANG'
                                WHEN [FKDCAB] = 023 then 'ULS MELAWAI'
                                WHEN [FKDCAB] = 024 then 'ULS GUDANG PELURU'
                                WHEN [FKDCAB] = 025 then 'ULS KEMANG MANSION'
                                WHEN [FKDCAB] = 026 then 'KCP KRANJI BEKASI'
                                WHEN [FKDCAB] = 027 then 'KCP PASAR ANYAR'
                                WHEN [FKDCAB] = 028 then 'KCP CILEDUG TANGERANG'
                                WHEN [FKDCAB] = 029 then 'ULS PERAK BARAT'
                                WHEN [FKDCAB] = 030 then 'KCU SEMARANG'
                                WHEN [FKDCAB] = 031 then 'ULS JUANDA BEKASI'
                                WHEN [FKDCAB] = 032 then 'ULS GEDANGAN'
                                WHEN [FKDCAB] = 033 then 'ULS GRESIK'
                                WHEN [FKDCAB] = 034 then 'ULS MAJAPAHIT'
                                WHEN [FKDCAB] = 035 then 'KCU BANDUNG'
                                WHEN [FKDCAB] = 036 then 'ULS PURI INDAH'
                                WHEN [FKDCAB] = 037 then 'KCU SOLO'
                                WHEN [FKDCAB] = 038 then 'KCP PONDOK GEDE'
                                WHEN [FKDCAB] = 039 then 'KCP CIBINONG'
                                WHEN [FKDCAB] = 040 then 'KCP CIKARANG SELATAN'
                                WHEN [FKDCAB] = 041 then 'KCP TANGERANG KOTA'
                                WHEN [FKDCAB] = 042 then 'KCP CIPUTAT'
                                WHEN [FKDCAB] = 043 then 'KCP DEPOK'
                                WHEN [FKDCAB] = 044 then 'KCP CILEUNGSI'
                                WHEN [FKDCAB] = 045 then 'KCP CIKARANG UTARA'
                                WHEN [FKDCAB] = 046 then 'KCU YOGYAKARTA'
                                WHEN [FKDCAB] = 047 then 'ULS PLUIT KENCANA'
                                WHEN [FKDCAB] = 048 then 'ULS SOLO SLAMET RIYADI'
                                WHEN [FKDCAB] = 049 then 'ULS DAGO'
                                WHEN [FKDCAB] = 050 then 'KCU MEDAN'
                                WHEN [FKDCAB] = 051 then 'ULS BINTARO'
                                WHEN [FKDCAB] = 052 then 'KCU PALEMBANG'
                                WHEN [FKDCAB] = 053 then 'KCP MALANG'
                                WHEN [FKDCAB] = 054 then 'ULS KOTABARU PARAHYANGAN'
                                WHEN [FKDCAB] = 055 then 'ULS SUDIRMAN'
                                WHEN [FKDCAB] = 056 then 'ULS KUDUS'
                                WHEN [FKDCAB] = 057 then 'ULS PEMUDA'
                                WHEN [FKDCAB] = 058 then 'ULS PANDAAN'
                                WHEN [FKDCAB] = 059 then 'ULS BUAH BATU'
                                WHEN [FKDCAB] = 060 then 'ULS SINGOSAREN'
                                WHEN [FKDCAB] = 061 then 'ULS SRAGEN'
                                WHEN [FKDCAB] = 062 then 'ULS MOJOKERTO'
                                WHEN [FKDCAB] = 063 then 'ULS KEPANJEN'
                                WHEN [FKDCAB] = 064 then 'ULS AHMAD RIFAI'
                                WHEN [FKDCAB] = 065 then 'ULS BINTARO'
                                WHEN [FKDCAB] = 066 then 'KCU BANDAR LAMPUNG'
                                WHEN [FKDCAB] = 067 then 'KCU BANDA ACEH'
                                WHEN [FKDCAB] = 068 then 'KCP KEDIRI'
                                WHEN [FKDCAB] = 069 then 'ULS SETIABUDI'
                                WHEN [FKDCAB] = 070 then 'KCP PASURUAN'
                                WHEN [FKDCAB] = 071 then 'KCU PANAKKUKANG'
                                WHEN [FKDCAB] = 072 then 'KCP LHOKSEUMAWE'
                                WHEN [FKDCAB] = 073 then 'ULS BIREUN'
                                WHEN [FKDCAB] = 074 then 'ULS TAMAN PONDOK INDAH'
                                WHEN [FKDCAB] = 075 then 'ULS SUDIRMAN PALEMBANG'
                                WHEN [FKDCAB] = 076 then 'KCP BANYUWANGI'
                                WHEN [FKDCAB] = 501 then 'LSBU BEKASI'
                                WHEN [FKDCAB] = 502 then 'LSBU CIBUBUR'
                                WHEN [FKDCAB] = 503 then 'LSBU KARAWANG'
                                WHEN [FKDCAB] = 504 then 'LSBU BANGKALAN'
                                WHEN [FKDCAB] = 505 then 'LSBU TUBAN'
                                WHEN [FKDCAB] = 506 then 'LSBU BABAT'
                                WHEN [FKDCAB] = 507 then 'LSBU PAMEKASAN'
                                WHEN [FKDCAB] = 508 then 'LSBU SAMPANG'
                                WHEN [FKDCAB] = 521 then 'LSBU CIREBON' 
                                WHEN [FKDCAB] = 522 then 'LSBU GARUT' 
                                WHEN [FKDCAB] = 523 then 'LSBU SUKABUMI' 
                                WHEN [FKDCAB] = 524 then 'LSBU TASIKMALAYA' 
                                WHEN [FKDCAB] = 525 then 'LSBU CIANJUR' 
                                WHEN [FKDCAB] = 526 then 'LSBU SUBANG' 
                                WHEN [FKDCAB] = 527 then 'LSBU PURWAKARTA' 
                                WHEN [FKDCAB] = 528 then 'LSBU INDRAMAYU' 
                                WHEN [FKDCAB] = 529 then 'LSBU JATIWANGI' 
                                WHEN [FKDCAB] = 530 then 'LSBU CIAMIS' 
                                WHEN [FKDCAB] = 531 then 'LSBU KUNINGAN CIREBON' 
                                WHEN [FKDCAB] = 532 then 'LSBU CIBADAK' 
                                WHEN [FKDCAB] = 533 then 'LSBU SUMEDANG' 
                                WHEN [FKDCAB] = 509 then 'LSBU PROBOLINGGO' 
                                WHEN [FKDCAB] = 510 then 'LSBU SITUBONDO' 
                                WHEN [FKDCAB] = 511 then 'LSBU TULUNGAGUNG' 
                                WHEN [FKDCAB] = 512 then 'LSBU BLITAR' 
                                WHEN [FKDCAB] = 513 then 'LSBU MADIUN' 
                                WHEN [FKDCAB] = 514 then 'LSBU PASURUAN' 
                                WHEN [FKDCAB] = 515 then 'LSBU KERTOSONO' 
                                WHEN [FKDCAB] = 516 then 'LSBU BANYUWANGI' 
                                WHEN [FKDCAB] = 517 then 'LSBU BONDOWOSO' 
                                WHEN [FKDCAB] = 518 then 'LSBU LUMAJANG' 
                                WHEN [FKDCAB] = 519 then 'LSBU MAGETAN' 
                                WHEN [FKDCAB] = 520 then 'LSBU NGAWI' 
                                WHEN [FKDCAB] = 534 then 'LSBU PURWOKERTO' 
                                WHEN [FKDCAB] = 535 then 'LSBU CILACAP' 
                                WHEN [FKDCAB] = 536 then 'LSBU PURWODADI' 
                                WHEN [FKDCAB] = 537 then 'LSBU MAGELANG' 
                                WHEN [FKDCAB] = 538 then 'LSBU PEKALONGAN' 
                                WHEN [FKDCAB] = 539 then 'LSBU SALATIGA' 
                                WHEN [FKDCAB] = 540 then 'LSBU TEGAL' 
                                WHEN [FKDCAB] = 541 then 'LSBU BANJARNEGARA' 
                                WHEN [FKDCAB] = 542 then 'LSBU WONOSOBO' 
                                WHEN [FKDCAB] = 543 then 'LSBU WONOGIRI' 
                                WHEN [FKDCAB] = 544 then 'LSBU PARAKAN' 
                                WHEN [FKDCAB] = 545 then 'LSBU JEPARA' 
                                WHEN [FKDCAB] = 546 then 'LSBU KEDUNGWUNI' 
                                WHEN [FKDCAB] = 547 then 'LSBU KUTUARJO' 
                                WHEN [FKDCAB] = 548 then 'LSBU BOYOLALI' 
                                WHEN [FKDCAB] = 549 then 'LSBU PURBALINGGA' 
                                WHEN [FKDCAB] = 550 then 'LSBU GOMBONG' 
                                WHEN [FKDCAB] = 551 then 'LSBU BLOK A CIPETE'
                                WHEN [FKDCAB] = 552 then 'LSBU CITY TOWER'
                                WHEN [FKDCAB] = 553 then 'LSBU KEBAYORAN BARU'
                                WHEN [FKDCAB] = 554 then 'LSBU KUNINGAN'
                                WHEN [FKDCAB] = 555 then 'LSBU MENARA BIDAKARA'
                                WHEN [FKDCAB] = 556 then 'LSBU PONDOK INDAH'
                                WHEN [FKDCAB] = 557 then 'LSBU SCBD'
                                WHEN [FKDCAB] = 558 then 'LSBU SUDIRMAN'
                                WHEN [FKDCAB] = 559 then 'LSBU THAMRIN'
                                WHEN [FKDCAB] = 560 then 'LSBU FATMAWATI'
                                WHEN [FKDCAB] = 561 then 'LSBU SABANG'
                                WHEN [FKDCAB] = 562 then 'LSBU MENTENG'
                                WHEN [FKDCAB] = 563 then 'LSBU PERMATA HIJAU'
                                WHEN [FKDCAB] = 564 then 'LSBU KEMANG'
                                WHEN [FKDCAB] = 565 then 'LSBU WARUNG BUNCIT'
                                WHEN [FKDCAB] = 566 then 'LSBU SANTA'
                                WHEN [FKDCAB] = 567 then 'LSBU GUNSA 45'
                                WHEN [FKDCAB] = 568 then 'LSBU KALIMALANG'
                                WHEN [FKDCAB] = 569 then 'LSBU KELAPA GADING'
                                WHEN [FKDCAB] = 570 then 'LSBU MATRAMAN'
                                WHEN [FKDCAB] = 571 then 'LSBU RAWAMANGUN'
                                WHEN [FKDCAB] = 572 then 'LSBU SUNTER'
                                WHEN [FKDCAB] = 573 then 'LSBU WISMA MILLENIA'
                                WHEN [FKDCAB] = 574 then 'LSBU SILIWANGI'
                                WHEN [FKDCAB] = 575 then 'LSBU CEMPAKA  PUTIH RAYA'
                                WHEN [FKDCAB] = 576 then 'LSBU SUNTER  AGUNG'
                                WHEN [FKDCAB] = 577 then 'LSBU DEWI SARTIKA'
                                WHEN [FKDCAB] = 578 then 'LSBU ASEMKA'
                                WHEN [FKDCAB] = 579 then 'LSBU GAJAH MADA'
                                WHEN [FKDCAB] = 580 then 'LSBU MANGGA DUA RAYA'
                                WHEN [FKDCAB] = 581 then 'LSBU MUARA KARANG'
                                WHEN [FKDCAB] = 582 then 'LSBU PANGERAN JAYAKARTA'
                                WHEN [FKDCAB] = 583 then 'LSBU PANTAI INDAH KAPUK'
                                WHEN [FKDCAB] = 584 then 'LSBU PASAR BARU'
                                WHEN [FKDCAB] = 585 then 'LSBU PLUIT'
                                WHEN [FKDCAB] = 586 then 'LSBU SURYOPRANOTO'
                                WHEN [FKDCAB] = 587 then 'LSBU TAMAN DUTA MAS'
                                WHEN [FKDCAB] = 588 then 'LSBU KHM MANSYUR'
                                WHEN [FKDCAB] = 589 then 'LSBU GROGOL MUWARDI'
                                WHEN [FKDCAB] = 590 then 'LSBU DAAN MOGOT'
                                WHEN [FKDCAB] = 591 then 'LSBU GREEN GARDEN'
                                WHEN [FKDCAB] = 592 then 'LSBU KEDOYA PERMAI'
                                WHEN [FKDCAB] = 593 then 'LSBU PURI INDAH'
                                WHEN [FKDCAB] = 594 then 'LSBU WAHID HASYIM'
                                WHEN [FKDCAB] = 595 then 'LSBU WISMA ASIA'
                                WHEN [FKDCAB] = 596 then 'LSBU KEPA DURI'
                                WHEN [FKDCAB] = 597 then 'LSBU KEBON JERUK' 
                                WHEN [FKDCAB] = 598 then 'LSBU METRO TANAH ABANG'
                                WHEN [FKDCAB] = 599 then 'LSBU KS TUBUN'
                                WHEN [FKDCAB] = 600 then 'LSBU TOMANG RAYA'
                                end as [NAMA_CABANG]
                        ,CIF.[FKDCAB] as [KODE_CABANG]	
                        ,CIF.[FCODE] as	[NOMOR_CIF]	
                        ,CONVERT(Varchar(20),[FTGLINPUT],103) as [TANGGAL_BUKA]	
                        ,CIF.[FNAMA] as	[NAMA_SESUAI_IDENTITAS]
                        ,CIF.[FREPNAME] as	[NAMA_TANPA_SINGKATAN]
                        ,CIF.[FTEMLAHIR] as [TEMPAT_LAHIR]
                        ,CONVERT(Varchar(20),[FTGLLAHIR],103) as [TANGGAL_LAHIR]
                        -- ,CIF.[FNAMAIBU] as [NAMA_IBU_KANDUNG]
                        ,CASE WHEN CIF.[FSEX] = 'L' THEN 'LAKI-LAKI'
                            WHEN CIF.[FSEX] = 'P' THEN 'PEREMPUAN' else 'Lainnya'
                            END AS [JENIS_KELAMIN]
                        ,CASE WHEN CIF.[FAGAMA] = 1 THEN 'ISLAM'
                            WHEN CIF.[FAGAMA]   = 2 THEN 'KRISTEN'
                            WHEN CIF.[FAGAMA]   = 3 THEN 'KATOLIK'
                            WHEN CIF.[FAGAMA]   = 4 THEN 'HINDU'
                            WHEN CIF.[FAGAMA]   = 5 THEN 'BUDHA'
                            WHEN CIF.[FAGAMA]   = 6 THEN 'LAINNYA'
                            END AS 'AGAMA'
                        ,CASE WHEN CIF.[FSTAKAWIN] = 1 THEN 'LAJANG'
                            WHEN CIF.[FSTAKAWIN] = 2 THEN 'KAWIN' 
                            WHEN CIF.[FSTAKAWIN] = 3 THEN 'JANDA/DUDA'
                            WHEN CIF.[FSTAKAWIN] = 4 THEN 'LAINNYA'
                            END AS [STATUS_PERKAWINAN] 
                        -- ,CASE WHEN CIF.[FKODEID] = 1 THEN 'KTP'
                        --     WHEN CIF.[FKODEID]   = 2 THEN 'SIM' 
                        --     WHEN CIF.[FKODEID]   = 3 THEN 'PASSPORT'
                        --     WHEN CIF.[FKODEID]   = 5 THEN 'KITAS'
                        --     WHEN CIF.[FKODEID]   = 7 THEN 'NIK/KK'
                        --     WHEN CIF.[FKODEID]   = 8 THEN 'AKTE KELAHIRAN'
                        --     WHEN CIF.[FKODEID]   = 9 THEN 'NIS / NISN'
                        --     WHEN CIF.[FKODEID]   = 10 THEN 'PERKUMPULAN NON FORMAL'
                        --     END AS [JENIS_IDENTITAS]
                        -- ,CIF.[FNPWP] as	[NOMOR_NPWP]
                        -- ,CIF.[FNOMORID] as [NOMOR_IDENTITAS]	
                        ,CONVERT(Varchar(20),[FTGLID],103) as [TANGGAL_IDENTITAS]	
                        ,CONVERT(Varchar(20),[FJTID],103) as [TANGGAL_JT_IDENTITAS]	
                        ,CIF.[FNEGARA] as [NEGARA_ASAL]
                        ,CIF.[FUSID] as [USER_INPUT]
                        ,CIF.[FAUTO] as [USER_OTOR]
                        ,CONVERT(Varchar(20),[FTGLAUTO],103) as [TGL_OTOR]
                        ,CONVERT(Varchar(20),[FTGLUBAH],103) as [TGL_PERUBAHAN]
                        ,CIF.[FJAMUBAH] as [JAM_PERUBAHAN]
                        ,CASE WHEN CIF.[FJNSNSB] = 'I' THEN 'INDIVIDU'
                            WHEN CIF.[FJNSNSB] = 'C' THEN 'KORPORASI'
                            END AS [JENIS_NASABAH]
                        ,CASE WHEN CIF.[FSTATUS] = 1 THEN 'AKTIF'
                            WHEN CIF.[FSTATUS] = 0 THEN 'TIDAK AKTIF'
                            END AS [STATUS]	
                        ,CIF.[PERIODE]
                        FROM [BCAS_MIS].[dbo].[CIF] WITH (NOLOCK)
                    WHERE CIF.FJNSNSB = 'I' 
                    and [FSTATUS] = 1
                    and 
                        (
                        -- CIF.[FNOMORID] = ''
                        CIF.[FREPNAME] = ''
                        or CIF.[FTEMLAHIR] = ''
                        -- or CIF.[FNAMAIBU] = ''
                        -- or CIF.[FNPWP] = ''
                        or CIF.[FNEGARA] = '')
                    and PERIODE = '$periode'
                    and CIF.[FTGLINPUT] between '$tgl_input' and '$tgl_inputakhir'
                    -- and [FKDCAB] in (001,002)
                    and [FKDCAB] = '$cabang'
                ) as a")->result();
        return $dataNpwp;
    }
}
